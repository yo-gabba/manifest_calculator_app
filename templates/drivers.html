{% extends "base.html" %}
{% block content %}
<h2>Drivers</h2>

<form method="POST" action="{{ url_for('drivers') }}">
  <label for="driver">Select Driver:</label>
  <select name="driver" id="driver" onchange="this.form.submit()">
    <option value="">-- Select --</option>
    {% for d in drivers %}
      <option value="{{ d.id }}" {% if selected_driver_id and d.id == selected_driver_id|int %}selected{% endif %}>
        {{ d.name }}
      </option>
    {% endfor %}
  </select>
</form>

{% if selected_driver_id %}
  <hr>
  <h3>Create Manifest</h3>
  <form method="POST" action="{{ url_for('create_manifest') }}">
    <input type="hidden" name="driver" value="{{ selected_driver_id }}">
    <label>Date:</label>
    <input type="date" name="date" required>
    <label style="margin-left:12px;">Start Odometer:</label>
    <input type="number" name="start_odometer" step="1" required>
    <label style="margin-left:12px;">End Odometer:</label>
    <input type="number" name="end_odometer" step="1" required>
    <button type="submit">Add Manifest</button>
  </form>

  <div style="margin-top:18px;">
    <strong>Today Miles:</strong> {{ totals.day_miles }}
    &nbsp;&nbsp;|&nbsp;&nbsp;
    <strong>Week Miles:</strong> {{ totals.week_miles }}
    &nbsp;&nbsp;|&nbsp;&nbsp;
    <strong>Today $:</strong> {{ "%.2f"|format(totals.day_total) }}
    &nbsp;&nbsp;|&nbsp;&nbsp;
    <strong>Week $:</strong> {{ "%.2f"|format(totals.week_total) }}
  </div>

  <h3 style="margin-top:18px;">Manifests</h3>
  <ul>
    {% for m in manifests %}
      <li>
        <a href="{{ url_for('manifest_detail', manifest_id=m.id) }}">
          {{ m.date }} — Miles: {{ m.total_miles }} — Day Total: ${{ "%.2f"|format(m.day_total or 0) }}
        </a>
      </li>
    {% else %}
      <li>No manifests yet.</li>
    {% endfor %}
  </ul>
{% endif %}
{% endblock %}
